<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jorge Borja">

<title>Caso 1: Análisis de la copa mundial femenina – Prueba Naowee</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./case2_introduction.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5111478a3e739f981a6638106c7172e1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No se han encontrado resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./case1.html">Caso 1: Análisis de la copa mundial femenina</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Prueba Naowee</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Caso 1: Análisis de la copa mundial femenina</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Caso 2: Desempeño estudiantes de matemáticas</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case2_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Propuesta del caso</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case2_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis de los datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./case2_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelos predictivos</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#propuesta-del-caso" id="toc-propuesta-del-caso" class="nav-link active" data-scroll-target="#propuesta-del-caso">Propuesta del Caso</a>
  <ul class="collapse">
  <li><a href="#contexto-y-desafío" id="toc-contexto-y-desafío" class="nav-link" data-scroll-target="#contexto-y-desafío">Contexto y desafío</a></li>
  <li><a href="#el-reto-analítico" id="toc-el-reto-analítico" class="nav-link" data-scroll-target="#el-reto-analítico">El reto analítico</a></li>
  <li><a href="#metodología-y-enfoque" id="toc-metodología-y-enfoque" class="nav-link" data-scroll-target="#metodología-y-enfoque">Metodología y enfoque</a></li>
  <li><a href="#preguntas-clave" id="toc-preguntas-clave" class="nav-link" data-scroll-target="#preguntas-clave">Preguntas Clave</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos">Datos</a></li>
  </ul></li>
  <li><a href="#desarrollo-del-caso" id="toc-desarrollo-del-caso" class="nav-link" data-scroll-target="#desarrollo-del-caso">Desarrollo del caso</a>
  <ul class="collapse">
  <li><a href="#datos-y-utilidades" id="toc-datos-y-utilidades" class="nav-link" data-scroll-target="#datos-y-utilidades">0. Datos y utilidades</a>
  <ul class="collapse">
  <li><a href="#sec-AnalysisService" id="toc-sec-AnalysisService" class="nav-link" data-scroll-target="#sec-AnalysisService">Servicio para análisis de variables</a></li>
  <li><a href="#sec-ResultsService" id="toc-sec-ResultsService" class="nav-link" data-scroll-target="#sec-ResultsService">Servicio para análisis de resultados</a></li>
  </ul></li>
  <li><a href="#análisis-de-variables" id="toc-análisis-de-variables" class="nav-link" data-scroll-target="#análisis-de-variables">1. Análisis de variables</a></li>
  <li><a href="#validación-entre-tablas" id="toc-validación-entre-tablas" class="nav-link" data-scroll-target="#validación-entre-tablas">2. Validación entre tablas</a></li>
  <li><a href="#tabla-de-posiciones" id="toc-tabla-de-posiciones" class="nav-link" data-scroll-target="#tabla-de-posiciones">3. Tabla de posiciones</a></li>
  <li><a href="#tabla-de-goleadoras" id="toc-tabla-de-goleadoras" class="nav-link" data-scroll-target="#tabla-de-goleadoras">4. Tabla de goleadoras</a></li>
  <li><a href="#tabla-analítica" id="toc-tabla-analítica" class="nav-link" data-scroll-target="#tabla-analítica">5. Tabla analítica</a></li>
  </ul></li>
  <li><a href="#respuesta-a-preguntas" id="toc-respuesta-a-preguntas" class="nav-link" data-scroll-target="#respuesta-a-preguntas">Respuesta a preguntas</a>
  <ul class="collapse">
  <li><a href="#cómo-ha-cambiado-el-promedio-de-goles-por-partido-a-lo-largo-de-los-torneos" id="toc-cómo-ha-cambiado-el-promedio-de-goles-por-partido-a-lo-largo-de-los-torneos" class="nav-link" data-scroll-target="#cómo-ha-cambiado-el-promedio-de-goles-por-partido-a-lo-largo-de-los-torneos">1. ¿Cómo ha cambiado el promedio de goles por partido a lo largo de los torneos?</a></li>
  <li><a href="#cuáles-son-las-selecciones-con-mejor-desempeño-en-términos-de-victorias" id="toc-cuáles-son-las-selecciones-con-mejor-desempeño-en-términos-de-victorias" class="nav-link" data-scroll-target="#cuáles-son-las-selecciones-con-mejor-desempeño-en-términos-de-victorias">2. ¿Cuáles son las selecciones con mejor desempeño en términos de victorias?</a></li>
  <li><a href="#existen-tendencias-en-los-equipos-dominantes-y-con-peor-desempeño" id="toc-existen-tendencias-en-los-equipos-dominantes-y-con-peor-desempeño" class="nav-link" data-scroll-target="#existen-tendencias-en-los-equipos-dominantes-y-con-peor-desempeño">3. ¿Existen tendencias en los equipos dominantes y con peor desempeño?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Caso 1: Análisis de la copa mundial femenina</h1>
<p class="subtitle lead">Naowee</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://www.linkedin.com/in/jorgeborjas25/">Jorge Borja, Mag</a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="propuesta-del-caso" class="level1">
<h1>Propuesta del Caso</h1>
<section id="contexto-y-desafío" class="level2">
<h2 class="anchored" data-anchor-id="contexto-y-desafío">Contexto y desafío</h2>
<p>La Copa Mundial Femenina de la FIFA ha experimentado un crecimiento exponencial desde su primera edición en 1991, atrayendo una audiencia global y consolidando el fútbol femenino como un pilar del deporte internacional. Con la evolución del torneo, ha surgido la necesidad de analizar tendencias en el desempeño de las selecciones, patrones de juego y factores que contribuyen al éxito en la competición.</p>
</section>
<section id="el-reto-analítico" class="level2">
<h2 class="anchored" data-anchor-id="el-reto-analítico">El reto analítico</h2>
<p>La FIFA está interesada en un análisis detallado del rendimiento de los equipos en las distintas ediciones del torneo, identificando patrones en la cantidad de goles, frecuencia de victorias y desempeño a lo largo de los años. Se busca descubrir qué selecciones han dominado históricamente y cómo ha evolucionado el nivel de competitividad.</p>
</section>
<section id="metodología-y-enfoque" class="level2">
<h2 class="anchored" data-anchor-id="metodología-y-enfoque">Metodología y enfoque</h2>
<p>A través del análisis de datos de partidos de la Copa Mundial Femenina desde 1991 hasta 2023, se espera: - Identificar tendencias de goles y resultados a lo largo de los torneos. - Determinar los equipos con mayor rendimiento en cada edición. - Explorar patrones de juego y evolución del fútbol femenino a nivel internacional.</p>
</section>
<section id="preguntas-clave" class="level2">
<h2 class="anchored" data-anchor-id="preguntas-clave">Preguntas Clave</h2>
<ul>
<li>¿Cómo ha cambiado el promedio de goles por partido a lo largo de los torneos?</li>
<li>¿Cuáles son las selecciones con mejor desempeño en términos de victorias?</li>
<li>¿Existen tendencias en los equipos dominantes y con peor desempeño?</li>
</ul>
</section>
<section id="datos" class="level2">
<h2 class="anchored" data-anchor-id="datos">Datos</h2>
<p>Para la solución del caso, debe utilizar los siguientes dataset: <a href="https://raw.githubusercontent.com/daramireh/simonBolivarCienciaDatos/refs/heads/main/world_cup_women.csv">world_cup_women.csv</a> y <a href="https://raw.githubusercontent.com/daramireh/simonBolivarCienciaDatos/refs/heads/main/matches_1991_2023.csv">world_cup_matches.csv</a></p>
</section>
</section>
<section id="desarrollo-del-caso" class="level1">
<h1>Desarrollo del caso</h1>
<section id="datos-y-utilidades" class="level2">
<h2 class="anchored" data-anchor-id="datos-y-utilidades">0. Datos y utilidades</h2>
<div id="0d4a8083" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ast</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>url_wc <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/daramireh/simonBolivarCienciaDatos/refs/heads/main/world_cup_women.csv"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>url_matches <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/daramireh/simonBolivarCienciaDatos/refs/heads/main/matches_1991_2023.csv"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>world_cup <span class="op">=</span> pd.read_csv(url_wc)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> pd.read_csv(url_matches)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="sec-AnalysisService" class="level3">
<h3 class="anchored" data-anchor-id="sec-AnalysisService">Servicio para análisis de variables</h3>
<div id="bfe019f3" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Código</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AnalysisService:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, df: pd.DataFrame):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> df</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> summary(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        summary_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Column"</span>: <span class="va">self</span>.df.columns,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"# Rows"</span>: [<span class="va">self</span>.df.shape[<span class="dv">0</span>] <span class="cf">for</span> _ <span class="kw">in</span> <span class="va">self</span>.df.columns],</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"# Nulls"</span>: [<span class="va">self</span>.df[col].isna().<span class="bu">sum</span>() <span class="cf">for</span> col <span class="kw">in</span> <span class="va">self</span>.df.columns],</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Type"</span>: [<span class="va">self</span>.df[col].dtype <span class="cf">for</span> col <span class="kw">in</span> <span class="va">self</span>.df.columns],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        duplicated_rows <span class="op">=</span> <span class="va">self</span>.df.duplicated().<span class="bu">sum</span>()</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>duplicated_rows<span class="sc">}</span><span class="ss"> duplicated rows"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(summary_df)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> related_columns(df1: pd.DataFrame, df2: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        common_columns <span class="op">=</span> <span class="bu">set</span>(df1.columns) <span class="op">&amp;</span> <span class="bu">set</span>(df2.columns)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        validation <span class="op">=</span> []</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> common_columns:</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            only_in_df1 <span class="op">=</span> <span class="bu">set</span>(df1[col].dropna()) <span class="op">-</span> <span class="bu">set</span>(df2[col].dropna())</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            only_in_df2 <span class="op">=</span> <span class="bu">set</span>(df2[col].dropna()) <span class="op">-</span> <span class="bu">set</span>(df1[col].dropna())</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            validation.append(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"column"</span>: col,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"df1_nulls"</span>: df1[col].isna().<span class="bu">sum</span>(),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"df2_nulls"</span>: df2[col].isna().<span class="bu">sum</span>(),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"only_df1"</span>: <span class="bu">len</span>(only_in_df1),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"only_df2"</span>: <span class="bu">len</span>(only_in_df2),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        val_df <span class="op">=</span> pd.DataFrame(validation)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Common columns: </span><span class="sc">{</span>common_columns<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(val_df)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="sec-ResultsService" class="level3">
<h3 class="anchored" data-anchor-id="sec-ResultsService">Servicio para análisis de resultados</h3>
<div id="e8677343" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Código</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ResultsService:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data: pd.DataFrame):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> data</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.base_matches <span class="op">=</span> <span class="va">self</span>._build_base_matches()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.matches <span class="op">=</span> <span class="va">self</span>._build_results_matches()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _parse_events(x) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.isna(x) <span class="kw">or</span> <span class="bu">isinstance</span>(x, <span class="bu">list</span>):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> x <span class="cf">if</span> <span class="bu">isinstance</span>(x, <span class="bu">list</span>) <span class="cf">else</span> []</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(x, <span class="bu">str</span>):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                parsed <span class="op">=</span> ast.literal_eval(x)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> parsed <span class="cf">if</span> <span class="bu">isinstance</span>(parsed, <span class="bu">list</span>) <span class="cf">else</span> []</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">SyntaxError</span>):</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> []</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _count_events(x) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(ResultsService._parse_events(x))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _parse_penalty_goals(x) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.isna(x) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(x, <span class="bu">str</span>):</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> []</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>            event.split(<span class="st">"·"</span>)[<span class="dv">0</span>].replace(<span class="st">"(P)"</span>, <span class="st">""</span>).strip() <span class="cf">for</span> event <span class="kw">in</span> x.split(<span class="st">"|"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _explode_events(<span class="va">self</span>, df, event_col, team_col, parser):</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            df[[event_col, team_col]]</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            .dropna()</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            .assign(player<span class="op">=</span><span class="kw">lambda</span> x: x[event_col].<span class="bu">apply</span>(parser))</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>            .explode(<span class="st">"player"</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            .drop(columns<span class="op">=</span>event_col)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            .dropna()</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            .rename(columns<span class="op">=</span>{team_col: <span class="st">"team"</span>})</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _count_goal_assists(<span class="va">self</span>, df, goal_col, team_col):</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            df[[goal_col, team_col, <span class="st">"Year"</span>, <span class="st">"Host"</span>]]</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            .dropna(subset<span class="op">=</span>[goal_col])</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            .assign(events<span class="op">=</span><span class="kw">lambda</span> x: x[goal_col].<span class="bu">apply</span>(<span class="va">self</span>._parse_events))</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>            .explode(<span class="st">"events"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>            .assign(has_assist<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"events"</span>].<span class="bu">str</span>.contains(<span class="st">"Assist:"</span>))</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            .rename(columns<span class="op">=</span>{team_col: <span class="st">"team"</span>})</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            .groupby([<span class="st">"Year"</span>, <span class="st">"Host"</span>, <span class="st">"team"</span>])[<span class="st">"has_assist"</span>]</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">sum</span>()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            .reset_index(name<span class="op">=</span><span class="st">"assists"</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _build_base_matches(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        cols_home <span class="op">=</span> [</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Year"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Host"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Attendance"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_team"</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_score"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">"away_score"</span>,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_yellow_card_long"</span>,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_red_card"</span>,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        cols_away <span class="op">=</span> [</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Year"</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Host"</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Attendance"</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">"away_team"</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">"away_score"</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_score"</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">"away_yellow_card_long"</span>,</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">"away_red_card"</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        cols_final <span class="op">=</span> [</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Year"</span>,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Host"</span>,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Attendance"</span>,</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">"team"</span>,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">"goals_for"</span>,</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">"goals_against"</span>,</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">"yellow_cards"</span>,</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">"red_cards"</span>,</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>        home <span class="op">=</span> <span class="va">self</span>.data[cols_home].copy()</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        home.columns <span class="op">=</span> cols_final</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        away <span class="op">=</span> <span class="va">self</span>.data[cols_away].copy()</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>        away.columns <span class="op">=</span> cols_final</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.concat([home, away], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _build_results_matches(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.base_matches.copy()</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"yellow_cards"</span>] <span class="op">=</span> df[<span class="st">"yellow_cards"</span>].<span class="bu">apply</span>(<span class="va">self</span>._count_events)</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"red_cards"</span>] <span class="op">=</span> df[<span class="st">"red_cards"</span>].<span class="bu">apply</span>(<span class="va">self</span>._count_events)</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"win"</span>] <span class="op">=</span> (df[<span class="st">"goals_for"</span>] <span class="op">&gt;</span> df[<span class="st">"goals_against"</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"draw"</span>] <span class="op">=</span> (df[<span class="st">"goals_for"</span>] <span class="op">==</span> df[<span class="st">"goals_against"</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"loss"</span>] <span class="op">=</span> (df[<span class="st">"goals_for"</span>] <span class="op">&lt;</span> df[<span class="st">"goals_against"</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"points"</span>] <span class="op">=</span> df[<span class="st">"win"</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> df[<span class="st">"draw"</span>]</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"fair_play"</span>] <span class="op">=</span> <span class="op">-</span>df[<span class="st">"yellow_cards"</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> df[<span class="st">"red_cards"</span>]</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_results(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> (</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.matches.groupby(<span class="st">"team"</span>)</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>            .agg(</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                GP<span class="op">=</span>(<span class="st">"team"</span>, <span class="st">"count"</span>),</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                W<span class="op">=</span>(<span class="st">"win"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                D<span class="op">=</span>(<span class="st">"draw"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                L<span class="op">=</span>(<span class="st">"loss"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>                GF<span class="op">=</span>(<span class="st">"goals_for"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                GA<span class="op">=</span>(<span class="st">"goals_against"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>                FP<span class="op">=</span>(<span class="st">"fair_play"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                Points<span class="op">=</span>(<span class="st">"points"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>            .reset_index()</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>        results[<span class="st">"GD"</span>] <span class="op">=</span> results[<span class="st">"GF"</span>] <span class="op">-</span> results[<span class="st">"GA"</span>]</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> results[</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"team"</span>, <span class="st">"GP"</span>, <span class="st">"W"</span>, <span class="st">"D"</span>, <span class="st">"L"</span>, <span class="st">"GF"</span>, <span class="st">"GA"</span>, <span class="st">"GD"</span>, <span class="st">"FP"</span>, <span class="st">"Points"</span>]</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results.sort_values(</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>            by<span class="op">=</span>[<span class="st">"Points"</span>, <span class="st">"GD"</span>], ascending<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        ).rename(columns<span class="op">=</span>{<span class="st">"team"</span>: <span class="st">"Team"</span>})</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> top_scorers(</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, include_penalties: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, top_n: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        parser <span class="op">=</span> <span class="kw">lambda</span> x: [e.split(<span class="st">"|"</span>)[<span class="dv">2</span>].strip() <span class="cf">for</span> e <span class="kw">in</span> <span class="va">self</span>._parse_events(x)]</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        goals_play <span class="op">=</span> pd.concat(</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._explode_events(<span class="va">self</span>.data, <span class="st">"home_goal_long"</span>, <span class="st">"home_team"</span>, parser),</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._explode_events(<span class="va">self</span>.data, <span class="st">"away_goal_long"</span>, <span class="st">"away_team"</span>, parser),</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>            ignore_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>        dfs <span class="op">=</span> [goals_play]</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> include_penalties:</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>            penalties <span class="op">=</span> pd.concat(</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>                [</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>._explode_events(</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.data,</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"home_penalty_goal"</span>,</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"home_team"</span>,</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>._parse_penalty_goals,</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>._explode_events(</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.data,</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"away_penalty_goal"</span>,</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"away_team"</span>,</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>._parse_penalty_goals,</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>                ignore_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>            dfs.append(penalties)</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>        scorers <span class="op">=</span> (</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>            pd.concat(dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>            .value_counts([<span class="st">"player"</span>, <span class="st">"team"</span>])</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>            .reset_index(name<span class="op">=</span><span class="st">"Goals"</span>)</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>            .sort_values(<span class="st">"Goals"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>            .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>        scorers[<span class="st">"Position"</span>] <span class="op">=</span> (</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>            scorers[<span class="st">"Goals"</span>].rank(method<span class="op">=</span><span class="st">"min"</span>, ascending<span class="op">=</span><span class="va">False</span>).astype(<span class="bu">int</span>)</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>        scorers <span class="op">=</span> scorers[[<span class="st">"Position"</span>, <span class="st">"player"</span>, <span class="st">"team"</span>, <span class="st">"Goals"</span>]].rename(</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{<span class="st">"player"</span>: <span class="st">"Player"</span>, <span class="st">"team"</span>: <span class="st">"Team"</span>}</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> scorers.sort_values([<span class="st">"Position"</span>, <span class="st">"Player"</span>], ignore_index<span class="op">=</span><span class="va">True</span>).head(</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>            top_n</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> world_cup_summary(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> (</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.matches.groupby([<span class="st">"Year"</span>, <span class="st">"Host"</span>, <span class="st">"team"</span>])</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>            .agg(</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>                GP<span class="op">=</span>(<span class="st">"team"</span>, <span class="st">"count"</span>),</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>                GF<span class="op">=</span>(<span class="st">"goals_for"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>                GF_avg<span class="op">=</span>(<span class="st">"goals_for"</span>, <span class="st">"mean"</span>),</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>                GA<span class="op">=</span>(<span class="st">"goals_against"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>                GA_avg<span class="op">=</span>(<span class="st">"goals_against"</span>, <span class="st">"mean"</span>),</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>                W<span class="op">=</span>(<span class="st">"win"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>                D<span class="op">=</span>(<span class="st">"draw"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>                L<span class="op">=</span>(<span class="st">"loss"</span>, <span class="st">"sum"</span>),</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>            .reset_index()</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>        assists <span class="op">=</span> (</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>            pd.concat(</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>                [</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>._count_goal_assists(<span class="va">self</span>.data, <span class="st">"home_goal_long"</span>, <span class="st">"home_team"</span>),</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>._count_goal_assists(<span class="va">self</span>.data, <span class="st">"away_goal_long"</span>, <span class="st">"away_team"</span>),</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>                ignore_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>            .groupby([<span class="st">"Year"</span>, <span class="st">"Host"</span>, <span class="st">"team"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"assists"</span>]</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">sum</span>()</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> summary.merge(assists, on<span class="op">=</span>[<span class="st">"Year"</span>, <span class="st">"Host"</span>, <span class="st">"team"</span>], how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>        summary[<span class="st">"assists"</span>] <span class="op">=</span> summary[<span class="st">"assists"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>        summary[<span class="st">"Assist Avg"</span>] <span class="op">=</span> summary[<span class="st">"assists"</span>] <span class="op">/</span> summary[<span class="st">"GP"</span>]</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> summary[</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Year"</span>,</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Host"</span>,</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>                <span class="st">"team"</span>,</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GP"</span>,</span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GF"</span>,</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GF_avg"</span>,</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GA"</span>,</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>                <span class="st">"GA_avg"</span>,</span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>                <span class="st">"W"</span>,</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>                <span class="st">"D"</span>,</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>                <span class="st">"L"</span>,</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Assist Avg"</span>,</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>        summary.columns <span class="op">=</span> [</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Year"</span>,</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Host"</span>,</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Team"</span>,</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>            <span class="st">"GP"</span>,</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>            <span class="st">"GF"</span>,</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>            <span class="st">"GF Avg"</span>,</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>            <span class="st">"GA"</span>,</span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>            <span class="st">"GA Avg"</span>,</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">"W"</span>,</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>            <span class="st">"D"</span>,</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>            <span class="st">"L"</span>,</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Assist Avg"</span>,</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> summary.sort_values(</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>            by<span class="op">=</span>[<span class="st">"Year"</span>, <span class="st">"GF"</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>], ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="análisis-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-variables">1. Análisis de variables</h2>
<p>Se debe realizar un análisis donde identifique las variables del conjunto de datos mostrando los valores nulos, duplicados y el tipo de variable.</p>
<p>Para el análisis de las variables, se usará la clase definida en la <a href="#sec-AnalysisService" class="quarto-xref">Sección&nbsp;2.1.1</a> utilizando la función <code>summary()</code>.</p>
<div id="504a321b" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>analysis_wc <span class="op">=</span> AnalysisService(world_cup)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>analysis_matches <span class="op">=</span> AnalysisService(matches)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>analysis_wc.summary()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>analysis_matches.summary()</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
0 duplicated rows
          Column  # Rows  # Nulls    Type
0           Year       9        0   int64
1           Host       9        0  object
2          Teams       9        0   int64
3       Champion       9        1  object
4      Runner-Up       9        1  object
5     TopScorrer       9        0  object
6     Attendance       9        0   int64
7  AttendanceAvg       9        0   int64
8        Matches       9        0   int64

0 duplicated rows
                             Column  # Rows  # Nulls     Type
0                         home_team     348        0   object
1                         away_team     348        0   object
2                        home_score     348        0    int64
3                           home_xg     348      232  float64
4                      home_penalty     348      337  float64
5                        away_score     348        0    int64
6                           away_xg     348      232  float64
7                      away_penalty     348      337  float64
8                      home_manager     348      180   object
9                      home_captain     348      180   object
10                     away_manager     348      180   object
11                     away_captain     348      180   object
12                       Attendance     348        0    int64
13                            Venue     348        0   object
14                        Officials     348        3   object
15                            Round     348        0   object
16                             Date     348        0   object
17                            Score     348        0   object
18                          Referee     348        7   object
19                            Notes     348      328   object
20                             Host     348        0   object
21                             Year     348        0    int64
22                        home_goal     348       96   object
23                        away_goal     348      148   object
24                   home_goal_long     348       96   object
25                   away_goal_long     348      148   object
26                    home_own_goal     348      330   object
27                    away_own_goal     348      335   object
28                home_penalty_goal     348      294   object
29                away_penalty_goal     348      313   object
30           home_penalty_miss_long     348      335   object
31           away_penalty_miss_long     348      341   object
32  home_penalty_shootout_goal_long     348      337   object
33  away_penalty_shootout_goal_long     348      337   object
34  home_penalty_shootout_miss_long     348      340   object
35  away_penalty_shootout_miss_long     348      338   object
36                    home_red_card     348      340   object
37                    away_red_card     348      337   object
38             home_yellow_red_card     348      340   object
39             away_yellow_red_card     348      345   object
40            home_yellow_card_long     348      135   object
41            away_yellow_card_long     348      118   object
42          home_substitute_in_long     348        4   object
43          away_substitute_in_long     348        5   object</code></pre>
</div>
</div>
</section>
<section id="validación-entre-tablas" class="level2">
<h2 class="anchored" data-anchor-id="validación-entre-tablas">2. Validación entre tablas</h2>
<p>Se debe realizar una validación cruzada entre las tablas, identifique los campos que relacionan las tablas y si existen datos faltantes en dichos campos.</p>
<p>Para el análisis de las variables, se usará la clase definida en la <a href="#sec-AnalysisService" class="quarto-xref">Sección&nbsp;2.1.1</a> utilizando la función <code>related_columns()</code>.</p>
<div id="5e6b9873" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>AnalysisService.related_columns(world_cup, matches)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Common columns: {'Attendance', 'Host', 'Year'}

       column  df1_nulls  df2_nulls  only_df1  only_df2
0  Attendance          0          0         9       254
1        Host          0          0         0         0
2        Year          0          0         0         0</code></pre>
</div>
</div>
</section>
<section id="tabla-de-posiciones" class="level2">
<h2 class="anchored" data-anchor-id="tabla-de-posiciones">3. Tabla de posiciones</h2>
<p>Se debe elaborar la tabla de posiciones del mundial realizado en 1991. Tenga en cuenta que cada partido ganado da 3 puntos, cada parti do empatado da 1 punto. Así mismo, las tarjetas amarillas suman -1 punto para juego limpio y las tarjetas rojas – 2 puntos a juego limpio.</p>
<p>La tabla debe tener la siguiente estructura: Equipo | Partidos Jugados (PJ) | Partidos Ganados (PG) | Partidos Empatados (PE) | Partidos Perdidos (PP)| Goles a Favor (GF) | Goles en Contra (GC) | Diferencia de Goles (GF – GC) | Juego Limpio (JL) | Puntos</p>
<p>Para esto, debemos crear una copia del dataframe <code>matches</code> filtrada por el año 1991.</p>
<div id="5bb50817" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>matches_1991 <span class="op">=</span> matches[matches[<span class="st">'Year'</span>] <span class="op">==</span> <span class="dv">1991</span>].copy()</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Y, para calcular la tabla de posiciones, se usará la clase definida en la <a href="#sec-ResultsService" class="quarto-xref">Sección&nbsp;2.1.2</a> utilizando la función <code>get_results()</code>.</p>
<div id="84522ab1" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ResultsService(matches_1991)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>table_1991 <span class="op">=</span> results.get_results()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table_1991)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Team  GP  W  D  L  GF  GA  GD  FP  Points
0    United States   6  6  0  0  25   5  20  -4      18
1           Sweden   6  4  0  2  18   7  11  -6      12
2           Norway   6  4  0  2  14  10   4  -4      12
3          Germany   6  4  0  2  13  10   3  -3      12
4         China PR   4  2  1  1  10   4   6  -2       7
5            Italy   4  2  0  2   8   5   3  -3       6
6          Denmark   4  1  1  2   7   6   1  -2       4
7           Brazil   3  1  0  2   1   7  -6  -4       3
8   Chinese Taipei   4  1  0  3   2  15 -13  -1       3
9          Nigeria   3  0  0  3   0   7  -7  -2       0
10     New Zealand   3  0  0  3   1  11 -10   0       0
11           Japan   3  0  0  3   0  12 -12  -1       0</code></pre>
</div>
</div>
</section>
<section id="tabla-de-goleadoras" class="level2">
<h2 class="anchored" data-anchor-id="tabla-de-goleadoras">4. Tabla de goleadoras</h2>
<p>Se debe elaborar la tabla de goleadoras del mundial de 2023.</p>
<p>Para esto, debemos crear una copia del dataframe <code>matches</code> filtrada por el año 2023.</p>
<div id="a544e48f" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>matches_2023 <span class="op">=</span> matches[matches[<span class="st">'Year'</span>] <span class="op">==</span> <span class="dv">2023</span>].copy()</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Esta tabla será calculada utilizando la clase definida en la <a href="#sec-ResultsService" class="quarto-xref">Sección&nbsp;2.1.2</a> utilizando la función <code>top_scorers()</code>.</p>
<div id="3daf4e4e" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ResultsService(matches_2023)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>top_scorers_2023 <span class="op">=</span> results.top_scorers()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_scorers_2023)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Position             Player         Team  Goals
0         1    Hinata Miyazawa        Japan      5
1         2     Alexandra Popp      Germany      4
2         2    Amanda Ilestedt       Sweden      4
3         2         Jill Roord  Netherlands      4
4         2   Kadidiatou Diani       France      4
5         6     Aitana Bonmatí        Spain      3
6         6       Alba Redondo        Spain      3
7         6      Alessia Russo      England      3
8         6         Ary Borges       Brazil      3
9         6  Eugénie Le Sommer       France      3</code></pre>
</div>
</div>
</section>
<section id="tabla-analítica" class="level2">
<h2 class="anchored" data-anchor-id="tabla-analítica">5. Tabla analítica</h2>
<p>Debe construir una rutina cuya salida sea <strong>UNA ÚNICA TABLA</strong> que muestre:</p>
<p>Año | Host | Equipo | Partidos Jugados | Goles Totales marcados | Promedio de Goles marcados | Goles Totales recibidos | promedio de goles recibidos | partidos totales ganados | partidos totales perdidos | partidos totales empatados | promedio de asistencia por equipo.</p>
<p>Esta tabla será calculada utilizando la clase definida en la <a href="#sec-ResultsService" class="quarto-xref">Sección&nbsp;2.1.2</a> utilizando la función <code>world_cup_summary()</code>.</p>
<div id="034a023f" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ResultsService(matches)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> results.world_cup_summary()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Year                    Host                 Team  GP  GF    GF Avg  GA  \
0    1991                China PR        United States   6  25  4.166667   5   
1    1991                China PR               Sweden   6  18  3.000000   7   
2    1991                China PR               Norway   6  14  2.333333  10   
3    1991                China PR              Germany   6  13  2.166667  10   
4    1991                China PR             China PR   4  10  2.500000   4   
..    ...                     ...                  ...  ..  ..       ...  ..   
163  2023  Australia, New Zealand          New Zealand   3   1  0.333333   1   
164  2023  Australia, New Zealand          Philippines   3   1  0.333333   8   
165  2023  Australia, New Zealand  Republic of Ireland   3   1  0.333333   3   
166  2023  Australia, New Zealand                Haiti   3   0  0.000000   4   
167  2023  Australia, New Zealand              Vietnam   3   0  0.000000  12   

       GA Avg  W  D  L  Assist Avg  
0    0.833333  6  0  0    0.000000  
1    1.166667  4  0  2    0.000000  
2    1.666667  4  0  2    0.000000  
3    1.666667  4  0  2    0.000000  
4    1.000000  2  1  1    0.000000  
..        ... .. .. ..         ...  
163  0.333333  1  1  1    0.333333  
164  2.666667  1  0  2    0.333333  
165  1.000000  0  1  2    0.000000  
166  1.333333  0  0  3    0.000000  
167  4.000000  0  0  3    0.000000  

[168 rows x 12 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="respuesta-a-preguntas" class="level1">
<h1>Respuesta a preguntas</h1>
<p>En esta sección se responderán las preguntas claves planteadas en el caso.</p>
<section id="cómo-ha-cambiado-el-promedio-de-goles-por-partido-a-lo-largo-de-los-torneos" class="level2">
<h2 class="anchored" data-anchor-id="cómo-ha-cambiado-el-promedio-de-goles-por-partido-a-lo-largo-de-los-torneos">1. ¿Cómo ha cambiado el promedio de goles por partido a lo largo de los torneos?</h2>
<p>Para hallar el promedio de goles realizados por partido, debemos tomar los goles marcados por equipo. Para ello, usaremos la tabla <code>summary</code> obtenida en la sección anterior.</p>
<div id="58c590db" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>goals_trend <span class="op">=</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    summary.groupby(<span class="st">"Year"</span>).agg({<span class="st">"GF"</span>: <span class="st">"sum"</span>, <span class="st">"GA"</span>: <span class="st">"sum"</span>}).reset_index()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>goals_trend[<span class="st">"Total Goals Avg"</span>] <span class="op">=</span> (goals_trend[<span class="st">"GF"</span>] <span class="op">+</span> goals_trend[<span class="st">"GA"</span>]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Average Goals Trend:"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(goals_trend)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average Goals Trend:
   Year   GF   GA  Total Goals Avg
0  1991   99   99             99.0
1  1995   99   99             99.0
2  1999  122  122            122.0
3  2003  105  105            105.0
4  2007  111  111            111.0
5  2011   86   86             86.0
6  2015  146  146            146.0
7  2019  146  146            146.0
8  2023  164  164            164.0</code></pre>
</div>
</div>
<div id="33ca0da1" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="case1_files/figure-html/cell-13-output-1.png" width="667" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar, a medida que avanzan los años, el promedio de goles por partido ha aumentado. Esto puede deberse a factores como el aumento de la calidad de los equipos, la mejora en el entrenamiento y la tecnología utilizada en el juego. Además, también puede deberse a la introducción de nuevas reglas y cambios en el formato del torneo, como del aumento de equipos participantes.</p>
</section>
<section id="cuáles-son-las-selecciones-con-mejor-desempeño-en-términos-de-victorias" class="level2">
<h2 class="anchored" data-anchor-id="cuáles-son-las-selecciones-con-mejor-desempeño-en-términos-de-victorias">2. ¿Cuáles son las selecciones con mejor desempeño en términos de victorias?</h2>
<div id="992bfd12" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>best_teams <span class="op">=</span> (</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    summary.groupby(<span class="st">"Team"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">"W"</span>: <span class="st">"sum"</span>, <span class="st">"GP"</span>: <span class="st">"sum"</span>, <span class="st">"GF"</span>: <span class="st">"sum"</span>, <span class="st">"GA"</span>: <span class="st">"sum"</span>})</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>best_teams[<span class="st">"Win Rate"</span>] <span class="op">=</span> (best_teams[<span class="st">"W"</span>] <span class="op">/</span> best_teams[<span class="st">"GP"</span>] <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>best_teams[<span class="st">"GD"</span>] <span class="op">=</span> best_teams[<span class="st">"GF"</span>] <span class="op">-</span> best_teams[<span class="st">"GA"</span>]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>best_teams <span class="op">=</span> best_teams.sort_values(<span class="st">"W"</span>, ascending<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top 10 teams:"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(best_teams[[<span class="st">"Team"</span>, <span class="st">"GP"</span>, <span class="st">"W"</span>, <span class="st">"Win Rate"</span>, <span class="st">"GD"</span>]].head(<span class="dv">10</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Top 10 teams:
            Team  GP   W  Win Rate   GD
0  United States  54  41     75.93  103
1        Germany  47  30     63.83   87
2         Sweden  47  28     59.57   34
3         Norway  44  25     56.82   45
4         Brazil  37  21     56.76   29
5        England  33  20     60.61   22
6          Japan  38  18     47.37   -8
7       China PR  36  17     47.22   15
8         France  24  13     54.17   20
9    Netherlands  16  10     62.50   14</code></pre>
</div>
</div>
<p>Este resultado es interesante pues, si tuviesemos en cuenta el ratio de victorias y no solo la cantidad de partidos ganados, podríamos decir que el top 3 de selecciones con mejor desempeño en términos de ratio de victorias es:</p>
<ol type="1">
<li>Estados Unidos</li>
<li>Alemania</li>
<li>Paises Bajos</li>
</ol>
</section>
<section id="existen-tendencias-en-los-equipos-dominantes-y-con-peor-desempeño" class="level2">
<h2 class="anchored" data-anchor-id="existen-tendencias-en-los-equipos-dominantes-y-con-peor-desempeño">3. ¿Existen tendencias en los equipos dominantes y con peor desempeño?</h2>
<p>Esta es una pregunta bastante curiosa, pues no necesariamente una selección que logró ganar muchos mundiales en el pasado, se mantendrá como una selección dominante en el futuro. Pues, cada año nacen nuevos jugadores que pueden tener un gran impacto en el desempeño de sus selecciones.</p>
<div id="24fe5269" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dominant_teams <span class="op">=</span> best_teams[best_teams[<span class="st">"GP"</span>] <span class="op">&gt;=</span> <span class="dv">10</span>].sort_values(<span class="st">"Win Rate"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Most dominant teams (min 10 games):"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dominant_teams[[<span class="st">"Team"</span>, <span class="st">"GP"</span>, <span class="st">"W"</span>, <span class="st">"Win Rate"</span>, <span class="st">"GD"</span>]].head(<span class="dv">10</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>worst_teams <span class="op">=</span> best_teams[best_teams[<span class="st">"GP"</span>] <span class="op">&gt;=</span> <span class="dv">10</span>].sort_values(<span class="st">"Win Rate"</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Worst performing teams (min 10 games):"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(worst_teams[[<span class="st">"Team"</span>, <span class="st">"GP"</span>, <span class="st">"W"</span>, <span class="st">"Win Rate"</span>, <span class="st">"GD"</span>]].head(<span class="dv">10</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Most dominant teams (min 10 games):
             Team  GP   W  Win Rate   GD
0   United States  54  41     75.93  103
1         Germany  47  30     63.83   87
9     Netherlands  16  10     62.50   14
5         England  33  20     60.61   22
2          Sweden  47  28     59.57   34
3          Norway  44  25     56.82   45
4          Brazil  37  21     56.76   29
8          France  24  13     54.17   20
12          Spain  14   7     50.00    9
6           Japan  38  18     47.37   -8

Worst performing teams (min 10 games):
              Team  GP   W  Win Rate  GD
34       Argentina  12   0      0.00 -35
29     New Zealand  18   1      5.56 -26
27  Korea Republic  13   1      7.69 -24
14         Nigeria  30   5     16.67 -42
18       Korea DPR  13   3     23.08  -8
15         Denmark  18   5     27.78  -7
11          Canada  30   9     30.00 -21
10       Australia  33  10     30.30 -10
16        Colombia  12   4     33.33  -3
13           Italy  15   7     46.67   3</code></pre>
</div>
</div>
<p>Con esto podemos evidenciar lo mencionado anteriormente: que un equipo haya ganado muchos partidos en el pasado no necesariamente tendrá un buen desempeño en el futuro.</p>
<div id="8d3b2245" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>team_evolution <span class="op">=</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    summary.groupby([<span class="st">"Team"</span>, <span class="st">"Year"</span>]).agg({<span class="st">"W"</span>: <span class="st">"sum"</span>, <span class="st">"GP"</span>: <span class="st">"sum"</span>}).reset_index()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>team_evolution[<span class="st">"Win Rate"</span>] <span class="op">=</span> (team_evolution[<span class="st">"W"</span>] <span class="op">/</span> team_evolution[<span class="st">"GP"</span>] <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>consistency <span class="op">=</span> (</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    team_evolution.groupby(<span class="st">"Team"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">"Win Rate"</span>: [<span class="st">"mean"</span>, <span class="st">"std"</span>, <span class="st">"count"</span>]})</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>consistency.columns <span class="op">=</span> [<span class="st">"Team"</span>, <span class="st">"Avg Win Rate"</span>, <span class="st">"Std Win Rate"</span>, <span class="st">"Tournaments"</span>]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>consistency <span class="op">=</span> consistency[consistency[<span class="st">"Tournaments"</span>] <span class="op">&gt;=</span> <span class="dv">3</span>].sort_values(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Win Rate"</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Most consistent teams (min 3 tournaments):"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(consistency.head(<span class="dv">10</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Most inconsistent teams (min 3 tournaments):"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(consistency.tail(<span class="dv">10</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Most consistent teams (min 3 tournaments):
             Team  Avg Win Rate  Std Win Rate  Tournaments
0       Argentina      0.000000      0.000000            4
1          Mexico      0.000000      0.000000            3
2  Korea Republic      6.250000     12.500000            4
3           Italy     44.165000     13.160407            4
4     New Zealand      5.555000     13.606916            6
5       Korea DPR     22.915000     15.773278            4
6        China PR     45.623750     17.882370            8
7         Denmark     26.666000     18.065929            5
8         England     56.548333     18.683954            6
9         Nigeria     14.814444     18.992364            9

Most inconsistent teams (min 3 tournaments):
            Team  Avg Win Rate  Std Win Rate  Tournaments
0         Norway     53.518889     22.212675            9
1         Canada     25.832500     22.307056            8
2        Germany     61.798889     22.370461            9
3      Australia     25.982500     22.869996            8
4  United States     73.412222     24.353055            9
5         Sweden     54.762222     25.394233            9
6       Colombia     28.333333     30.138569            3
7    Netherlands     56.903333     30.473235            3
8          Japan     38.782222     31.871468            9
9          Spain     36.903333     44.077410            3</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introducción">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introducción</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./case2_introduction.html" class="pagination-link" aria-label="Propuesta del caso">
        <span class="nav-page-text">Propuesta del caso</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>